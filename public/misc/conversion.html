<html>
<head>
	<title>Conversion test</title>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/4.5.2/pixi.js"></script>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<style>
		.source_canvas {
			border: 2px solid #f00;
		}

		.dest_canvas {
			border: 2px solid #0f0;	
		}
	</style>
</head>
<body>
<h1>Conversion test</h1>
<h2>Before canvas extract:</h2>
<div id="before"></div>
<h2>After canvas extract:</h2>
<div id="after"></div>
<script>
	var renderer, container, graphics;

	function main() {
		console.log("main()");

		// Render the circle
		setup();
		renderCircle();
		createCanvas();
	}

	function setup() {
		// Create the source canvas to render a circle onto
		renderer = PIXI.autoDetectRenderer(200, 200, {
			"antialias": true,
			"transparent": true,
			"clearBeforeRender": false,
			"preserveDrawingBuffer": true
		});
		var view = $(self.renderer.view);
		$("#before").append(view);
		view.addClass("source_canvas");

		container = new PIXI.Container();
		graphics = new PIXI.Graphics();
		container.addChild(graphics);
	}

	function renderCircle() {
		graphics.beginFill(0xff0000, 0.2);
		graphics.lineStyle(0);
		graphics.drawCircle(100, 100, 50);
		graphics.endFill();
		renderer.render(container);
	}

	function createCanvas() {
		var stagingContainer = new PIXI.Container();
		stagingContainer.addChild(graphics);
		var canvas = renderer.extract.canvas(stagingContainer);
		$("#after").append(canvas);	
		$(canvas).addClass("dest_canvas");
	}

	main();
</script>
</body>
</html